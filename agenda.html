<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Barber Intel | PKACCI</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0f111a; --card: #1a1d2e; --primary: #8257e5; --accent: #00f2fe; --text: #ffffff; }
        body { background: var(--bg); color: var(--text); font-family: 'Poppins', sans-serif; margin: 0; padding-bottom: 100px; }
        
        .header { padding: 20px; background: rgba(26, 29, 46, 0.9); border-bottom: 1px solid #333; sticky: top; }
        .balance-card { background: linear-gradient(135deg, #8257e5, #2e1a47); padding: 20px; border-radius: 20px; margin-top: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }

        /* --- GRÁFICO CORRIGIDO --- */
        .chart-container { background: var(--card); margin: 20px; padding: 20px; border-radius: 20px; border: 1px solid #333; }
        .bars-wrapper { display: flex; align-items: flex-end; justify-content: space-between; height: 120px; gap: 10px; padding-top: 10px; }
        .bar-group { display: flex; flex-direction: column; align-items: center; flex: 1; height: 100%; justify-content: flex-end; }
        
        /* Forçando a cor e visibilidade das barras */
        .bar { 
            width: 100%; 
            background: #333; /* Cor de fundo caso o resto falhe */
            border-radius: 6px 6px 2px 2px; 
            min-height: 5px; /* Garante que a barra nunca suma totalmente */
            background: rgba(130, 87, 229, 0.4); /* Roxo suave para dias passados */
        }
        
        .bar.active { 
            background: #00f2fe !important; /* Azul Neon sólido */
            box-shadow: 0 0 15px #00f2fe; /* Brilho para destacar */
        }

        .bar-label { font-size: 0.6rem; margin-top: 8px; opacity: 0.6; font-weight: 600; }

        /* Lista */
        .appointment-card { background: var(--card); margin: 10px 20px; padding: 15px; border-radius: 18px; display: flex; align-items: center; border: 1px solid #333; }
        .time-badge { background: #29292e; color: var(--primary); padding: 8px; border-radius: 10px; font-weight: 600; font-size: 0.8rem; }
        .client-info { flex-grow: 1; margin-left: 15px; }
        .btn-zap { background: #04d361; color: white; border: none; padding: 10px 15px; border-radius: 10px; font-weight: 600; }
        .btn-del { color: #ff4b4b; background: none; border: none; font-size: 1.2rem; margin-left: 10px; }

        .fab { position: fixed; bottom: 30px; right: 25px; background: linear-gradient(45deg, var(--primary), var(--accent)); width: 60px; height: 60px; border-radius: 20px; color: #fff; font-size: 2rem; border: none; box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

    <header class="header">
        <h2 style="margin:0;">Barber Intel</h2>
        <div class="balance-card">
            <small>Faturamento de Hoje</small>
            <div id="total" style="font-size: 2rem; font-weight: 600;">R$ 0,00</div>
        </div>
    </header>

    <div class="chart-container">
        <div style="font-size: 0.7rem; opacity: 0.5; margin-bottom: 10px; text-transform: uppercase;">Desempenho Semanal</div>
        <div class="bars-wrapper">
            <div class="bar-group"><div class="bar" style="height: 30%;"></div><span class="bar-label">SEG</span></div>
            <div class="bar-group"><div class="bar" style="height: 60%;"></div><span class="bar-label">TER</span></div>
            <div class="bar-group"><div class="bar" style="height: 45%;"></div><span class="bar-label">QUA</span></div>
            <div class="bar-group"><div class="bar" style="height: 80%;"></div><span class="bar-label">QUI</span></div>
            <div class="bar-group"><div class="bar active" id="todayBar" style="height: 10%;"></div><span class="bar-label" style="color:#00f2fe">HOJE</span></div>
        </div>
    </div>

    <div id="list"></div>
    <button class="fab" onclick="document.getElementById('modal').style.display='flex'">+</button>

    <div id="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:200; align-items:center; justify-content:center;">
        <div style="background:var(--card); width:85%; padding:25px; border-radius:25px;">
            <input type="text" id="name" placeholder="Nome" style="width:100%; padding:15px; margin-bottom:10px; background:#0f111a; border:1px solid #333; color:white; border-radius:12px;">
            <input type="time" id="time" style="width:100%; padding:15px; margin-bottom:10px; background:#0f111a; border:1px solid #333; color:white; border-radius:12px;">
            <button onclick="add()" style="width:100%; background:var(--primary); padding:15px; border:none; border-radius:12px; color:white; font-weight:600;">Agendar</button>
            <button onclick="this.parentElement.parentElement.style.display='none'" style="width:100%; background:none; border:none; color:#888; margin-top:15px;">Cancelar</button>
        </div>
    </div>

    <script>
        function add() {
            const n = document.getElementById('name').value;
            const t = document.getElementById('time').value;
            if(!n || !t) return;
            const item = { id: Date.now(), name: n, time: t, price: 25 };
            let data = JSON.parse(localStorage.getItem('barber_v6')) || [];
            data.push(item);
            localStorage.setItem('barber_v6', JSON.stringify(data));
            location.reload(); // Recarrega para aplicar a barra de hoje
        }

        function del(id) {
            let data = JSON.parse(localStorage.getItem('barber_v6')) || [];
            data = data.filter(i => i.id !== id);
            localStorage.setItem('barber_v6', JSON.stringify(data));
            render();
        }

        function render() {
            const list = document.getElementById('list');
            const data = JSON.parse(localStorage.getItem('barber_v6')) || [];
            let total = 0;
            list.innerHTML = "";
            data.forEach(item => {
                total += item.price;
                list.innerHTML += `<div class="appointment-card">
                    <div class="time-badge">${item.time}</div>
                    <div class="client-info"><h3>${item.name}</h3><span style="color:#04d361">R$ ${item.price}</span></div>
                    <button class="btn-zap" onclick="window.open('https://wa.me/?text=Confirmado')">Zap</button>
                    <button class="btn-del" onclick="del(${item.id})">×</button>
                </div>`;
            });
            document.getElementById('total').innerText = `R$ ${total},00`;
            const h = Math.min((total / 500) * 100, 100);
            document.getElementById('todayBar').style.height = (h + 5) + '%';
        }
        render();
    </script>
</body>
</html>
